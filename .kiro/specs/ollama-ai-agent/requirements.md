# Requirements Document

## Introduction

Локальный AI агент на базе Ollama для работы с нормативной документацией по закупкам. Система должна обеспечивать загрузку документов в базу знаний, поиск по документам и проверку соответствия новых документов нормативным требованиям. Агент должен поддерживать сессии для сохранения контекста общения.

## Requirements

### Requirement 1

**User Story:** Как пользователь, я хочу загружать нормативные документы (txt/md) в базу знаний, чтобы агент мог использовать их для ответов на вопросы.

#### Acceptance Criteria

1. WHEN пользователь загружает текстовый файл (txt/md) THEN система SHALL сохранить документ в базе знаний
2. WHEN документ загружается THEN система SHALL проиндексировать его содержимое для поиска
3. WHEN загрузка завершена THEN система SHALL подтвердить успешное добавление документа
4. IF файл имеет неподдерживаемый формат THEN система SHALL отклонить загрузку с соответствующим сообщением

### Requirement 2

**User Story:** Как пользователь, я хочу задавать общие вопросы по нормативной документации, чтобы получать ответы на основе загруженных документов.

#### Acceptance Criteria

1. WHEN пользователь задает вопрос THEN система SHALL найти релевантные фрагменты в базе знаний
2. WHEN релевантная информация найдена THEN Ollama модель SHALL сгенерировать ответ на основе найденных документов
3. WHEN ответ сформирован THEN система SHALL указать источники информации из базы знаний
4. IF релевантная информация не найдена THEN система SHALL сообщить об отсутствии данных по запросу

### Requirement 3

**User Story:** Как пользователь, я хочу проверять внешние документы (например, договоры) на соответствие нормативным требованиям, чтобы убедиться в возможности заключения сделки с конкретным поставщиком.

#### Acceptance Criteria

1. WHEN пользователь предоставляет документ для разовой проверки THEN система SHALL проанализировать его содержимое относительно нормативных документов из базы знаний
2. WHEN анализ завершен THEN система SHALL предоставить заключение о соответствии документа нормативным требованиям
3. WHEN найдены нарушения или несоответствия THEN система SHALL указать конкретные проблемы со ссылками на соответствующие нормативы
4. WHEN документ соответствует всем требованиям THEN система SHALL подтвердить возможность заключения договора

### Requirement 4

**User Story:** Как пользователь, я хочу работать в рамках сессий, чтобы агент запоминал историю нашего общения.

#### Acceptance Criteria

1. WHEN пользователь начинает новую сессию THEN система SHALL создать уникальный идентификатор сессии
2. WHEN в рамках сессии задается вопрос THEN система SHALL учитывать всю предыдущую историю общения
3. WHEN пользователь начинает новую сессию THEN система SHALL очистить историю предыдущих сессий
4. WHEN сессия активна THEN система SHALL сохранять все сообщения и ответы в контексте сессии

### Requirement 5

**User Story:** Как пользователь, я хочу использовать локальные Ollama модели, чтобы обеспечить конфиденциальность и независимость от внешних сервисов.

#### Acceptance Criteria

1. WHEN система запускается THEN она SHALL подключиться к локальному экземпляру Ollama
2. WHEN модель недоступна THEN система SHALL сообщить об ошибке подключения
3. WHEN генерируется ответ THEN система SHALL использовать только локальные модели Ollama
4. IF Ollama сервис недоступен THEN система SHALL предоставить информативное сообщение об ошибке

### Requirement 6

**User Story:** Как пользователь, я хочу иметь простой интерфейс для взаимодействия с агентом, чтобы легко управлять документами и задавать вопросы.

#### Acceptance Criteria

1. WHEN пользователь запускает приложение THEN система SHALL предоставить интуитивный интерфейс
2. WHEN пользователь выбирает действие THEN интерфейс SHALL четко показать доступные опции
3. WHEN происходит загрузка или обработка THEN система SHALL показывать индикатор прогресса
4. WHEN возникает ошибка THEN система SHALL отобразить понятное сообщение об ошибке

### Requirement 7

**User Story:** Как пользователь, я хочу запускать весь проект через docker-compose, чтобы легко развернуть систему со всеми зависимостями.

#### Acceptance Criteria

1. WHEN пользователь выполняет docker-compose up THEN система SHALL запустить все необходимые сервисы (Ollama, ChromaDB, AI Agent)
2. WHEN контейнеры запущены THEN все компоненты SHALL быть доступны и готовы к работе
3. WHEN система запускается впервые THEN docker-compose SHALL автоматически загрузить необходимые образы
4. WHEN пользователь останавливает систему THEN docker-compose SHALL корректно завершить все сервисы
5. IF требуется обновление THEN система SHALL поддерживать перезапуск без потери данных
